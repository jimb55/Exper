<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="931" height="579" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[一号->服务端:发现 缓存中 pierce_count 不存在
二号->服务端:发现 缓存中 pierce_count 不存在\n（不存在的原因是一号在找数据库，需要一秒多,\n而一号和二号访问几乎是同一时间的）

服务端->服务端:一号到数据库中找，找一秒
服务端->服务端:二号到数据库中找，找一秒

服务端->服务端:一号从数据库中找到记录且写到cache
服务端->服务端:二号从数据库中找到记录且写到cache

服务端-->一号:返回结果
服务端-->二号:返回结果

一秒过后访问的三号->服务端:发现 缓存中 pierce_count 存在
服务端->服务端:一号到cache中找，用时远远低于一秒
服务端-->一秒过后访问的三号:返回结果]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><path d="M10,20C50.3,17.8 23.0,22.2 64.0,20.0C62.5,43.2 65.5,48.1 64.0,57.0C23.2,54.8 50.4,59.2 10.0,57.0C8.5,40.7 11.5,48.1 10.0,20.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="21" y="43.5" style="font-size: 16px; font-family: danielbd;"><tspan x="20">一号</tspan></text></g><g class="actor"><path d="M10,522.390625C46.8,520.2 45.5,524.6 64.0,522.4C65.5,533.1 62.5,550.4 64.0,559.4C41.9,561.6 18.6,557.2 10.0,559.4C8.5,545.4 11.5,553.5 10.0,522.4" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="21" y="545.890625" style="font-size: 16px; font-family: danielbd;"><tspan x="20">一号</tspan></text></g><path d="M37.0,57.0C18.4,299.6 55.6,149.7 37.0,522.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="actor"><path d="M293.25,20C350.2,17.2 304.3,22.8 362.3,20.0C363.7,48.1 360.8,28.9 362.3,57.0C304.3,59.8 324.7,54.2 293.3,57.0C294.7,38.1 291.8,33.6 293.3,20.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="303.25" y="43.5" style="font-size: 16px; font-family: danielbd;"><tspan x="303.25">服务端</tspan></text></g><g class="actor"><path d="M293.25,522.390625C331.7,525.2 309.8,519.6 362.3,522.4C360.8,548.3 363.7,550.5 362.3,559.4C322.7,562.2 316.0,556.6 293.3,559.4C291.8,543.0 294.7,528.3 293.3,522.4" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="303.25" y="545.890625" style="font-size: 16px; font-family: danielbd;"><tspan x="303.25">服务端</tspan></text></g><path d="M327.8,57.0C309.1,443.5 346.4,410.7 327.8,522.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="actor"><path d="M662.578125,20C702.9,22.1 684.8,17.9 715.6,20.0C714.1,25.9 717.1,30.7 715.6,57.0C692.7,59.1 702.9,54.9 662.6,57.0C664.1,28.9 661.1,48.1 662.6,20.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="672.578125" y="43.5" style="font-size: 16px; font-family: danielbd;"><tspan x="672.578125">二号</tspan></text></g><g class="actor"><path d="M662.578125,522.390625C695.9,520.3 702.9,524.5 715.6,522.4C714.1,528.3 717.1,553.5 715.6,559.4C675.3,561.5 682.8,557.3 662.6,559.4C661.1,528.3 664.1,553.5 662.6,522.4" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="672.578125" y="545.890625" style="font-size: 16px; font-family: danielbd;"><tspan x="672.578125">二号</tspan></text></g><path d="M689.1,57.0C670.5,254.2 707.7,410.7 689.1,522.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="actor"><path d="M735.578125,20C773.5,13.4 875.0,26.6 901.6,20.0C903.1,28.9 900.1,25.9 901.6,57.0C764.8,63.6 827.4,50.4 735.6,57.0C734.1,29.2 737.1,25.9 735.6,20.0" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="746.578125" y="44" style="font-size: 16px; font-family: danielbd;"><tspan x="745.578125">一秒过后访问的三号</tspan></text></g><g class="actor"><path d="M735.578125,522.390625C861.7,529.0 868.2,515.8 901.6,522.4C903.1,534.7 900.1,531.3 901.6,559.4C864.0,552.8 837.3,566.0 735.6,559.4C737.1,532.9 734.1,553.5 735.6,522.4" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></path><text x="746.578125" y="546.390625" style="font-size: 16px; font-family: danielbd;"><tspan x="745.578125">一秒过后访问的三号</tspan></text></g><path d="M818.6,57.0C837.2,447.9 800.0,396.3 818.6,522.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><g class="signal"><text x="48" y="85" style="font-size: 16px; font-family: danielbd;"><tspan x="47">发现 缓存中 pierce_count 不存在</tspan></text><path d="M37.0,97.0C110.5,85.4 158.9,108.6 327.8,97.0" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="338.75" y="107.8046875" style="font-size: 16px; font-family: danielbd;"><tspan x="337.75">发现 缓存中 pierce_count 不存在</tspan><tspan dy="1.2em" x="337.75">（不存在的原因是一号在找数据库，需要一秒多,</tspan><tspan dy="1.2em" x="337.75">而一号和二号访问几乎是同一时间的）</tspan></text><path d="M689.1,171.4C414.5,156.9 602.4,185.8 327.8,171.4" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="353.75" y="204.390625" style="font-size: 16px; font-family: danielbd;"><tspan x="352.75">一号到数据库中找，找一秒</tspan></text><path d="M327.8,191.4C344.6,192.2 338.0,190.6 347.8,191.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><path d="M347.8,191.4C346.9,207.4 348.6,209.0 347.8,212.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><path d="M347.8,212.4C340.5,213.2 332.2,211.6 327.8,212.4" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="352.75" y="240.390625" style="font-size: 16px; font-family: danielbd;"><tspan x="352.75">二号到数据库中找，找一秒</tspan></text><path d="M327.8,227.4C336.8,226.6 344.6,228.2 347.8,227.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><path d="M347.8,227.4C348.6,245.0 346.9,241.6 347.8,248.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><path d="M347.8,248.4C344.3,249.2 337.1,247.6 327.8,248.4" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="353.75" y="276.890625" style="font-size: 16px; font-family: danielbd;"><tspan x="352.75">一号从数据库中找到记录且写到cache</tspan></text><path d="M327.8,263.4C330.9,264.2 344.6,262.6 347.8,263.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><path d="M347.8,263.4C348.6,269.9 346.9,274.3 347.8,285.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><path d="M347.8,285.4C344.6,284.6 330.9,286.2 327.8,285.4" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="352.75" y="313.890625" style="font-size: 16px; font-family: danielbd;"><tspan x="352.75">二号从数据库中找到记录且写到cache</tspan></text><path d="M327.8,300.4C335.8,299.6 335.5,301.2 347.8,300.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><path d="M347.8,300.4C348.6,311.2 346.9,316.8 347.8,322.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><path d="M347.8,322.4C334.1,321.6 334.0,323.2 327.8,322.4" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="150.375" y="347.390625" style="font-size: 16px; font-family: danielbd;"><tspan x="149.375">返回结果</tspan></text><path d="M327.8,353.4C213.5,365.0 106.8,341.8 37.0,353.4" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="476.4140625" y="383.390625" style="font-size: 16px; font-family: danielbd;"><tspan x="475.4140625">返回结果</tspan></text><path d="M327.8,389.4C631.3,374.9 550.6,403.8 689.1,389.4" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="446.7890625" y="417.390625" style="font-size: 16px; font-family: danielbd;"><tspan x="445.7890625">发现 缓存中 pierce_count 存在</tspan></text><path d="M818.6,429.4C453.5,449.0 700.8,409.8 327.8,429.4" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="353.75" y="462.890625" style="font-size: 16px; font-family: danielbd;"><tspan x="352.75">一号到cache中找，用时远远低于一秒</tspan></text><path d="M327.8,449.4C337.2,448.6 341.9,450.2 347.8,449.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><path d="M347.8,449.4C348.6,464.1 346.9,454.7 347.8,471.4" stroke="#000000" fill="none" style="stroke-width: 2;"></path><path d="M347.8,471.4C342.9,472.2 337.5,470.6 327.8,471.4" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g><g class="signal"><text x="541.1640625" y="496.390625" style="font-size: 16px; font-family: danielbd;"><tspan x="540.1640625">返回结果</tspan></text><path d="M327.8,502.4C406.3,522.0 740.0,482.8 818.6,502.4" stroke="#000000" fill="none" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></path></g></svg>